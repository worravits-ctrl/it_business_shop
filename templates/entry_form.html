{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header bg-primary text-white">
        <h5 class="card-title mb-0">
          <i class="fas fa-{% if entry %}edit{% else %}plus-circle{% endif %} me-2"></i>
          {% if entry %}แก้ไขรายการ{% else %}เพิ่มรายการใหม่{% endif %}
        </h5>
      </div>
      <div class="card-body">
        <form method="post">
          {{ form.hidden_tag() }}
          
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="{{ form.date.id }}" class="form-label">
                <i class="fas fa-calendar me-1"></i>{{ form.date.label.text }}
              </label>
              {{ form.date(class="form-control") }}
            </div>
            <div class="col-md-6">
              <label for="{{ form.type.id }}" class="form-label">
                <i class="fas fa-tag me-1"></i>{{ form.type.label.text }}
              </label>
              {{ form.type(class="form-select", id="typeSelect") }}
            </div>
          </div>
          
          <div class="mb-3">
            <label for="{{ form.category.id }}" class="form-label">
              <i class="fas fa-layer-group me-1"></i>{{ form.category.label.text }}
            </label>
            {{ form.category(class="form-select", id="categorySelect") }}
          </div>
          
          <div class="mb-3">
            <label for="{{ form.custom_category.id }}" class="form-label">
              <i class="fas fa-plus me-1"></i>{{ form.custom_category.label.text }}
            </label>
            {{ form.custom_category(class="form-control", placeholder="ใส่หมวดหมู่ใหม่ (ถ้าต้องการ)") }}
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>หากต้องการเพิ่มหมวดหมู่ใหม่ ให้พิมพ์ที่นี่ (จะใช้แทนการเลือกจากรายการด้านบน)
            </div>
          </div>
          
          <div class="mb-3">
            <label for="{{ form.description.id }}" class="form-label">
              <i class="fas fa-file-text me-1"></i>{{ form.description.label.text }}
            </label>
            {{ form.description(class="form-control", rows="3", placeholder="ระบุรายละเอียดเพิ่มเติม (ไม่บังคับ)") }}
          </div>
          
          <div class="mb-4">
            <label for="{{ form.amount.id }}" class="form-label">
              <i class="fas fa-money-bill me-1"></i>{{ form.amount.label.text }}
            </label>
            <div class="input-group">
              {{ form.amount(class="form-control", placeholder="0.00", step="0.01") }}
              <span class="input-group-text">บาท</span>
            </div>
          </div>
          
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <a href="{{ url_for('entries') }}" class="btn btn-secondary me-md-2">
              <i class="fas fa-times me-1"></i>ยกเลิก
            </a>
            {{ form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const typeSelect = document.getElementById('typeSelect');
  const categorySelect = document.getElementById('categorySelect');
  
  // Category options for income and expense
  const incomeOptions = [
    ['ถ่ายเอกสาร A4 ขาวดำ', 'ถ่ายเอกสาร A4 ขาวดำ'],
    ['ถ่ายเอกสาร A4 สี', 'ถ่ายเอกสาร A4 สี'],
    ['print A4 ขาวดำ', 'print A4 ขาวดำ'],
    ['print A4 สี', 'print A4 สี'],
    ['เคลือบบัตร ขนาดการ์ดทั่วไป', 'เคลือบบัตร ขนาดการ์ดทั่วไป'],
    ['เคลือบบัตร ขนาด A4', 'เคลือบบัตร ขนาด A4'],
    ['ถ่ายเอกสาร A3 สี', 'ถ่ายเอกสาร A3 สี'],
    ['ถ่ายเอกสาร A3 ขาวดำ', 'ถ่ายเอกสาร A3 ขาวดำ'],
    ['print A3 ขาวดำ', 'print A3 ขาวดำ'],
    ['print A3', 'print A3'],
    ['อื่นๆ', 'อื่นๆ']
  ];
  
  const expenseOptions = [
    ['ค่าหมึก', 'ค่าหมึก'],
    ['ค่ากระดาษ', 'ค่ากระดาษ'],
    ['ค่าน้ำ', 'ค่าน้ำ'],
    ['ค่าไฟ', 'ค่าไฟ'],
    ['อื่นๆ', 'อื่นๆ']
  ];
  
  function updateCategoryOptions() {
    const selectedType = typeSelect.value;
    const options = selectedType === 'income' ? incomeOptions : expenseOptions;
    
    // Clear existing options
    categorySelect.innerHTML = '';
    
    // Add new options
    options.forEach(function(option) {
      const optionElement = document.createElement('option');
      optionElement.value = option[0];
      optionElement.textContent = option[1];
      categorySelect.appendChild(optionElement);
    });
  }
  
  // Update categories when type changes
  typeSelect.addEventListener('change', updateCategoryOptions);
  
  // Initialize categories on page load
  updateCategoryOptions();
  
  // Set today's date as default if no date is set
  const dateInput = document.querySelector('input[type="date"]');
  if (dateInput && !dateInput.value) {
    const today = new Date().toISOString().split('T')[0];
    dateInput.value = today;
  }
});
</script>
{% endblock %}
